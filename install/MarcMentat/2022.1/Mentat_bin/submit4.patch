---
+++
@@ -63,10 +64,10 @@ doe_nparallel=$6
 if [ "$slv" != "" -a "$slv" != "marc" -a "$slv" != "datfit" ]; then
   slv="-iam sfm"
 fi
-if [ "$slv" == "marc" ]; then
+if [ "$slv" = "marc" ]; then
   slv=""
 fi
-if [ "$slv" == "datfit" ]; then
+if [ "$slv" = "datfit" ]; then
   slv="-iam datfit"
 fi
 
@@ -91,6 +92,7 @@ if [ "$srcfile" != "" -a "$srcfile" != "-" ]; then
       srcfile="-u $srcfile -save y"
       ;;
     runsaved)
+      srcfile=${srcfile%.*}".marc"
       srcfile="-prog $srcfile"
       ;;
   esac
@@ -189,12 +191,12 @@ unset PYTHONHOME
 unset PYTHONPATH
 
 if [ "$doe_first" = "-" ]; then # submit of regular Marc job
-  "${DIR}/tools/run_marc" $slv -j $job -v n -b y $nprocds $nprocd \
+  "${DIR}/tools/run_damask_hmp" $slv -j $job -v n -b y $nprocds $nprocd \
                           $srcfile $restart $postfile $viewfactorsfile $hostfile \
                           $compat $copy_datfile $copy_postfile $scr_dir $dcoup \
                           $assem_recov_nthread $nthread $nsolver $mode $gpu > /dev/null 2>&1
 else                            # submit of a DoE Marc job
-  "${DIR}/tools/run_marc" $slv -j $job -v n -b n $nprocds $nprocd \
+  "${DIR}/tools/run_damask_hmp" $slv -j $job -v n -b n $nprocds $nprocd \
                           $srcfile $restart $postfile $viewfactorsfile $hostfile \
                           $compat $copy_datfile $copy_postfile $scr_dir $dcoup \
                           $assem_recov_nthread $nthread $nsolver $mode $gpu
